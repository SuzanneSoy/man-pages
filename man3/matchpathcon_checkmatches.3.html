
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of matchpathcon_checkmatches</TITLE>
</HEAD><BODY>
<H1>matchpathcon_checkmatches</H1>
Section: SELinux API documentation (3)<BR>Updated: 21 November 2009<BR><A HREF="#index">Index</A>
<A HREF="/cgi-bin/man/man2html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

matchpathcon_checkmatches, matchpathcon_filespec_add, matchpathcon_filespec_destroy, matchpathcon_filespec_eval - check and report whether any specification index has no matches with any inode. Maintenance and statistics on inode associations
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:///usr/include/selinux/selinux.h">selinux/selinux.h</A>&gt;</B>

<P>
<B>void matchpathcon_checkmatches(char *</B><I>str</I><B>);</B>

<P>
<B>int matchpathcon_filespec_add(ino_t </B><I>ino</I><B>, int </B><I>specind</I><B>, const char *</B><I>file</I><B>);</B>

<P>
<B>void matchpathcon_filespec_destroy(void);</B>

<P>
<B>void matchpathcon_filespec_eval(void);</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>matchpathcon_checkmatches</B>()

checks whether any specification has no matches and reports them.
The
<I>str</I>

argument is used as a prefix for any warning messages.
<P>
<B>matchpathcon_filespec_add</B>()

maintains an association between an inode
<I>ino</I>

and a specification index
<I>specind</I>,

and checks whether a conflicting specification is already associated
with the same inode (e.g. due to multiple hard links). If so, then
it uses the latter of the two specifications based on their order in the 
<I>file</I>

context configuration. Returns the specification index used or -1 on
error.
<P>
<B>matchpathcon_filespec_destroy</B>()

destroys any inode associations that have been added, e.g. to restart
for a new filesystem.
<P>
<B>matchpathcon_filespec_eval</B>()

displays statistics on the hash table usage for the inode associations.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

Returns zero on success or -1 otherwise.
<A NAME="lbAF">&nbsp;</A>
<H2>SEE ALSO</H2>



<B><A HREF="/cgi-bin/man/man2html?8+selinux">selinux</A></B>(8), <B><A HREF="/cgi-bin/man/man2html?3+matchpathcon">matchpathcon</A></B>(3), <B><A HREF="/cgi-bin/man/man2html?3+matchpathcon_index">matchpathcon_index</A></B>(3), <B><A HREF="/cgi-bin/man/man2html?3+freecon">freecon</A></B>(3), <B><A HREF="/cgi-bin/man/man2html?3+setfilecon">setfilecon</A></B>(3), <B><A HREF="/cgi-bin/man/man2html?3+setfscreatecon">setfscreatecon</A></B>(3)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT id="1"><A HREF="#lbAB">NAME</A><DD>
<DT id="2"><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT id="3"><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT id="4"><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT id="5"><A HREF="#lbAF">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 00:05:47 GMT, March 31, 2021
</BODY>
</HTML>
